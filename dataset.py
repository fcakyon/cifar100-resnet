import torch
import torchvision


class Cifar100Dataset:
    def __init__(
        self,
        batch_size: int = 256,
        input_size: int = 32,
        num_workers=2,
        transforms=None,
    ):

        self.trainset = torchvision.datasets.CIFAR100(
            root="./data/CIFAR100",
            train=True,
            download=True,
            transform=transforms["train"],
        )

        self.trainloader = torch.utils.data.DataLoader(
            self.trainset, batch_size=batch_size, shuffle=True, num_workers=num_workers
        )

        self.testset = torchvision.datasets.CIFAR100(
            root="./data/CIFAR100",
            train=False,
            download=True,
            transform=transforms["test"],
        )

        self.testloader = torch.utils.data.DataLoader(
            self.testset, batch_size=batch_size, shuffle=False, num_workers=num_workers
        )

        self.classes = (
            "apples",
            "aquarium fish",
            "baby",
            "bear",
            "beaver",
            "bed",
            "bee",
            "beetle",
            "bicycle",
            "bottles",
            "bowls",
            "boy",
            "bridge",
            "bus",
            "butterfly",
            "camel",
            "cans",
            "castle",
            "caterpillar",
            "cattle",
            "chair",
            "chimpanzee",
            "clock",
            "cloud",
            "cockroach",
            "computer keyboard",
            "couch",
            "crab",
            "crocodile",
            "cups",
            "dinosaur",
            "dolphin",
            "elephant",
            "flatfish",
            "forest",
            "fox",
            "girl",
            "hamster",
            "house",
            "kangaroo",
            "lamp",
            "lawn-mower",
            "leopard",
            "lion",
            "lizard",
            "lobster",
            "man",
            "maple",
            "motorcycle",
            "mountain",
            "mouse",
            "mushrooms",
            "oak",
            "oranges",
            "orchids",
            "otter",
            "palm",
            "pears",
            "pickup truck",
            "pine",
            "plain",
            "plates",
            "poppies",
            "porcupine",
            "possum",
            "rabbit",
            "raccoon",
            "ray",
            "road",
            "rocket",
            "roses",
            "sea",
            "seal",
            "shark",
            "shrew",
            "skunk",
            "skyscraper",
            "snail",
            "snake",
            "spider",
            "squirrel",
            "streetcar",
            "sunflowers",
            "sweet peppers",
            "table",
            "tank",
            "telephone",
            "television",
            "tiger",
            "tractor",
            "train",
            "trout",
            "tulips",
            "turtle",
            "wardrobe",
            "whale",
            "willow",
            "wolf",
            "woman",
            "worm",
        )
